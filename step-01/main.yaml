# 14-MAY-2021, preparing the 2 switches with L2, bonding, bridge configuration
# 14-MAY-2021, hands-on via task-001.yaml and should include spine3 and leaf1
# 14-NOV-2021, cleaning up a bit
# 01-DEC-2021, updated bridge configuration 

- hosts: cumulus-nodes
  name: startup
  become: yes
  gather_facts: no
  tasks:
    - name: copy leaf1 task-01.yaml
      copy:
        src: /home/cumulus/ON-10/step-01/{{ inventory_hostname }}.yaml
        dest: /etc/nvue.d/startup.yaml
    # aktivieren
    - name: activate changes for leaf
      shell: nv config apply startup -y

- hosts: host
  name: Interfaces
  become: yes
  gather_facts: no
  tasks:
    - name: configure IPv4 address 
      copy:
        src: /home/cumulus/ON-10/step-01/{{ inventory_hostname }}
        dest: /etc/network/interfaces
    - name: activate changes 
      ansible.builtin.shell: /sbin/ifreload -a
    - name: verify
      ansible.builtin.shell: /sbin/ip -br a
      register: ipa
    - debug: msg={{ ipa.stdout }}
